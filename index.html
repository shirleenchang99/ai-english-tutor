<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI English Tutor</title>
<style>
body { font-family:'Comic Sans MS',Arial,sans-serif; background:linear-gradient(to bottom,#f0f6ff,#e0f7ff); margin:0;padding:0;}
header { background:#1E88E5; color:white; padding:20px; font-size:24px; text-align:center; box-shadow:0 4px 6px rgba(0,0,0,0.1);}
.nav { display:flex; justify-content:space-around; background:white; padding:10px 0;}
.nav button { background:#ffdd57; color:#333; font-weight:bold; transition:all 0.2s; border-radius:10px; padding:10px 20px; cursor:pointer;}
.nav button:hover { transform:scale(1.1); background:#ffd700;}
.section { padding:20px; display:none;}
.section.active { display:block;}
.card { background:white; padding:25px; border-radius:15px; margin-top:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
input, button { font-size:18px; padding:10px; border-radius:6px; border:1px solid #bbb; margin-top:10px;}
button { background:#1E88E5; color:white; border:none; cursor:pointer;}
#result { font-weight:bold; font-size:18px; margin-top:10px; animation:pop 0.3s ease-in-out;}
@keyframes pop {0% {transform: scale(0.8); opacity:0;}100% {transform: scale(1); opacity:1;}}
progress { width:100%; height:20px; border-radius:10px; overflow:hidden; margin-top:10px;}
</style>
</head>
<body>

<header>AI English Tutor</header>

<div class="nav">
  <button onclick="showSection('listen')">ğŸ§ é—¯å…³å¬å†™</button>
  <button onclick="showSection('words')">ğŸ“š ç”Ÿè¯æœ¬</button>
</div>

<div id="listen" class="section active">
  <div><b>å½“å‰å…³å¡ï¼š</b><span id="levelDisplay">1</span></div>
  <div class="card">
    <div id="sentenceDisplay">ç‚¹å‡»â€œæ’­æ”¾å¥å­â€å¼€å§‹</div>
    <button onclick="playSentence()">â–¶ æ’­æ”¾å¥å­</button><br>
    <input id="answer" placeholder="è¾“å…¥è‹±æ–‡">
    <div id="lengthHint" style="margin-top:5px; color:#555;"></div>
    <button onclick="checkAnswer()">æäº¤</button>
    <div id="result"></div>
    <div>
      <b>å®Œæˆå¥æ•°ï¼š</b><span id="doneCount">0</span>/5
      <progress id="progress" value="0" max="5"></progress>
    </div>
  </div>
</div>

<div id="words" class="section">
  <div class="card">
    <b>ç”Ÿè¯æœ¬ï¼š</b>
    <ul id="wordList"></ul>
    <button onclick="clearWords()">æ¸…ç©ºç”Ÿè¯æœ¬</button>
  </div>
</div>

<script>
// åˆç‰ˆå¥å­åº“ï¼ˆä¸­â†’è‹±ï¼‰
const sentences = [
{en:"I like to play football with my friends.", cn:"æˆ‘å–œæ¬¢å’Œæœ‹å‹è¸¢è¶³çƒã€‚"},
{en:"She reads a book every evening before bed.", cn:"å¥¹æ¯å¤©æ™šä¸Šç¡è§‰å‰éƒ½ä¼šçœ‹ä¹¦ã€‚"},
{en:"We are going to the park this afternoon.", cn:"ä»Šå¤©ä¸‹åˆæˆ‘ä»¬è¦å»å…¬å›­ã€‚"},
{en:"My father cooks delicious food on weekends.", cn:"æˆ‘çˆ¸çˆ¸å‘¨æœ«ä¼šåšç¾å‘³çš„é£Ÿç‰©ã€‚"},
{en:"The cat is sleeping under the warm blanket.", cn:"çŒ«æ­£ç¡åœ¨æ¸©æš–çš„æ¯¯å­ä¸‹é¢ã€‚"},
{en:"He enjoys drawing pictures in his notebook.", cn:"ä»–å–œæ¬¢åœ¨ç¬”è®°æœ¬ä¸Šç”»ç”»ã€‚"},
{en:"Today is a sunny day for a picnic.", cn:"ä»Šå¤©æ˜¯é€‚åˆé‡é¤çš„æ™´å¤©ã€‚"},
{en:"Please help me carry these heavy bags.", cn:"è¯·å¸®æˆ‘æè¿™äº›é‡åŒ…ã€‚"},
{en:"My little sister loves her new doll.", cn:"æˆ‘å¦¹å¦¹å–œæ¬¢å¥¹çš„æ–°æ´‹å¨ƒå¨ƒã€‚"},
{en:"We watched a movie together last night.", cn:"æˆ‘ä»¬æ˜¨æ™šä¸€èµ·çœ‹äº†ä¸€éƒ¨ç”µå½±ã€‚"}
// â€¦å¯æ‰©å±•åˆ°200å¥
];

let currentSentence = {};
let doneCount = 0;
let level = 1;
let wrongWords = JSON.parse(localStorage.getItem("wrongWords")||"[]");

const ansInput = document.getElementById("answer");
ansInput.addEventListener('input', ()=>{
  document.getElementById("lengthHint").innerText = `è¾“å…¥é•¿åº¦ï¼š${ansInput.value.length} / ${currentSentence.en.length}`;
});

// åˆ‡æ¢ç•Œé¢
function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  showWrongWords();
}

// æ’­æ”¾ä¸­æ–‡æç¤º + è‹±æ–‡è¯­éŸ³
function playSentence(){
  currentSentence = sentences[Math.floor(Math.random()*sentences.length)];
  document.getElementById("sentenceDisplay").innerText = currentSentence.cn;
  const utter = new SpeechSynthesisUtterance(currentSentence.en);
  utter.lang = "en-US";
  speechSynthesis.speak(utter);
  document.getElementById("answer").value = "";
  document.getElementById("lengthHint").innerText = "";
  document.getElementById("result").innerHTML = "";
}

// é”™è¯¯åˆ’çº¿æ ‡æ³¨
function markMistakes(userInput, correct){
  let result = '';
  for(let i=0;i<correct.length;i++){
    if(userInput[i] === correct[i]) result += correct[i];
    else result += `<span style="text-decoration:underline red;">${userInput[i]||''}</span>`;
  }
  return result;
}

// æ£€æŸ¥ç­”æ¡ˆ
function checkAnswer(){
  const ans = document.getElementById("answer").value.trim();
  if(ans.toLowerCase() === currentSentence.en.toLowerCase()){
    document.getElementById("result").innerHTML = "âœ” å¤ªæ£’äº†ï¼å®Œå…¨æ­£ç¡®ï¼";
    doneCount++;
    document.getElementById("doneCount").innerText = doneCount;
    document.getElementById("progress").value = doneCount;
    if(doneCount >=5){
      level++;
      doneCount = 0;
      alert("ğŸ‰ æ­å–œï¼ä½ å®Œæˆäº†å…³å¡ " + (level-1) + "ï¼Œè§£é”ä¸‹ä¸€å…³ï¼");
      document.getElementById("levelDisplay").innerText = level;
      document.getElementById("progress").value = doneCount;
    }
    playSentence(); // è‡ªåŠ¨åŠ è½½ä¸‹ä¸€å¥
  } else {
    document.getElementById("result").innerHTML = "âŒ æœ‰é”™è¯¯ï¼Œè¯·ä¿®æ”¹ï¼š" + markMistakes(ans,currentSentence.en);
    if(!wrongWords.includes(currentSentence)) {
      wrongWords.push(currentSentence);
      localStorage.setItem("wrongWords", JSON.stringify(wrongWords));
    }
  }
}

// ç”Ÿè¯æœ¬
function showWrongWords(){
  const ul = document.getElementById("wordList");
  ul.innerHTML = "";
  wrongWords.forEach(w=>{
    ul.innerHTML += `<li>${w.cn} â†’ ${w.en}</li>`;
  });
}

// æ¸…ç©ºç”Ÿè¯æœ¬
function clearWords(){
  wrongWords = [];
  localStorage.setItem("wrongWords", JSON.stringify(wrongWords));
  showWrongWords();
}
</script>
</body>
</html>
